<html>
  <head>
    <title>XSS</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
      crossorigin="anonymous"
    />
    <script src="https://kit.fontawesome.com/952dfd9181.js" crossorigin="anonymous"></script>
  </head>

  <header><%- include(`_header`); %></header>

  <body>
    <div class="col-lg-12 text-center mt-5">
      <h1>Search user by username</h1>
    </div>
    <div class="col-md-4 offset-md-4 mt-5 border border-success pt-3">
    <form action="/xss" method="post">
    <div class="input-group mb-3">
      <input type="text" class="form-control" placeholder="Search......" name="query" aria-label="Recipient's username" style="width:90%">
      <div class="input-group-append">
        <button><span class="input-group-text" style="height: 29px"><i class="fa fa-search"></i></span></button>
      </div>
    </div>
    <div class="form-check">
      <input class="form-check-input" name="prevent" type="checkbox" value="true" id="prevent">
      <label class="form-check-label mt-1" for="prevent">
        Prevent XSS
      </label>
    </div>
    </form>
    </div>
    <div class="alert alert-info col-md-4 offset-md-4 mt-5" role="alert">
      <strong>Try:</strong> <%= "user<script>alert('test')</script>" %>
    </div>

    <% if (data) { %>
    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
    <h2>Search result for: <%- query %></h2>
    <table class="table">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Username</th>
          <th scope="col">Password</th>
          <th scope="col">Role</th>
        </tr>
      </thead>
      <tbody>
        <% for (const row of data) { %>
        <tr>
          <th scope="row"><%= row.id %></th>
          <td><%= row.username %></td>
          <td><%= row.password %></td>
          <td><%= row.role %></td>
        </tr>
        <% } %>
      </tbody>
    </table>
    <% } %>
  </body>
</html>
